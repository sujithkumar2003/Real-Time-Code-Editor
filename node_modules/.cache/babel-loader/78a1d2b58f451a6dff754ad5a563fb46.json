{"ast":null,"code":"import _asyncToGenerator from\"E:/Real-Time-Code-Editor/realtime-code-editor/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"E:\\\\Real-Time-Code-Editor\\\\realtime-code-editor\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useRef}from\"react\";import Codemirror from\"codemirror\";import\"codemirror/lib/codemirror.css\";import\"codemirror/theme/dracula.css\";import\"codemirror/mode/javascript/javascript\";import\"codemirror/mode/htmlmixed/htmlmixed\";import\"codemirror/mode/css/css\";import\"codemirror/addon/edit/closetag\";import\"codemirror/addon/edit/closebrackets\";import\"codemirror/addon/edit/matchbrackets\";import\"codemirror/addon/hint/javascript-hint\";import\"codemirror/addon/hint/html-hint\";import\"codemirror/addon/hint/css-hint\";import\"codemirror/addon/hint/show-hint.css\";import\"codemirror/addon/hint/show-hint\";import ACTIONS from\"../Actions\";import{jsx as _jsx}from\"react/jsx-runtime\";var Editor=function Editor(_ref){var socketRef=_ref.socketRef,roomId=_ref.roomId,onCodeChange=_ref.onCodeChange;var editorRef=useRef(null);useEffect(function(){function init(){return _init.apply(this,arguments);}function _init(){_init=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:editorRef.current=Codemirror.fromTextArea(document.getElementById(\"realtimeEditor\"),{mode:{name:\"htmlmixed\",json:true},theme:\"dracula\",autoCloseTags:true,autoCloseBrackets:true,lineNumbers:true,matchBrackets:true,extraKeys:{\"Ctrl-Space\":\"autocomplete\"},hintOptions:{completeSingle:false}});editorRef.current.on(\"change\",function(instance,changes){var origin=changes.origin;var code=instance.getValue();onCodeChange(code);if(origin!==\"setValue\"){socketRef.current.emit(ACTIONS.CODE_CHANGE,{roomId:roomId,code:code});}});editorRef.current.on(\"inputRead\",function(cm,change){if(change.text.length===1&&/^[a-zA-Z0-9_-]$/.test(change.text[0])&&!cm.state.completionActive){cm.showHint();}else if(change.text[0]===\"!\"){cm.setValue(\"<!DOCTYPE html>\\n<html lang=\\\"en\\\">\\n<head>\\n  <meta charset=\\\"UTF-8\\\">\\n  <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\\n  <title>My HTML Page</title>\\n  <link rel=\\\"stylesheet\\\" href=\\\"styles.css\\\">\\n</head>\\n<body>\\n  <script src=\\\"script.js\\\"></script>\\n</body>\\n</html>\");cm.setCursor({line:5,ch:2});}});editorRef.current.on(\"keyup\",function(cm,event){if(event.key===\".\"){cm.showHint();}});case 4:case\"end\":return _context.stop();}}},_callee);}));return _init.apply(this,arguments);}init();},[]);useEffect(function(){if(socketRef.current){socketRef.current.on(ACTIONS.CODE_CHANGE,function(_ref2){var code=_ref2.code;if(code!==null){editorRef.current.setValue(code);}});}return function(){socketRef.current.off(ACTIONS.CODE_CHANGE);};},[socketRef.current]);return/*#__PURE__*/_jsx(\"textarea\",{id:\"realtimeEditor\"});};export default Editor;","map":{"version":3,"sources":["E:/Real-Time-Code-Editor/realtime-code-editor/src/components/Editor.js"],"names":["React","useEffect","useRef","Codemirror","ACTIONS","Editor","socketRef","roomId","onCodeChange","editorRef","init","current","fromTextArea","document","getElementById","mode","name","json","theme","autoCloseTags","autoCloseBrackets","lineNumbers","matchBrackets","extraKeys","hintOptions","completeSingle","on","instance","changes","origin","code","getValue","emit","CODE_CHANGE","cm","change","text","length","test","state","completionActive","showHint","setValue","setCursor","line","ch","event","key","off"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from \"react\";\r\nimport Codemirror from \"codemirror\";\r\nimport \"codemirror/lib/codemirror.css\";\r\nimport \"codemirror/theme/dracula.css\";\r\nimport \"codemirror/mode/javascript/javascript\";\r\nimport \"codemirror/mode/htmlmixed/htmlmixed\";\r\nimport \"codemirror/mode/css/css\";\r\nimport \"codemirror/addon/edit/closetag\";\r\nimport \"codemirror/addon/edit/closebrackets\";\r\nimport \"codemirror/addon/edit/matchbrackets\";\r\nimport \"codemirror/addon/hint/javascript-hint\";\r\nimport \"codemirror/addon/hint/html-hint\";\r\nimport \"codemirror/addon/hint/css-hint\";\r\nimport \"codemirror/addon/hint/show-hint.css\";\r\nimport \"codemirror/addon/hint/show-hint\";\r\n\r\nimport ACTIONS from \"../Actions\";\r\n\r\nconst Editor = ({ socketRef, roomId, onCodeChange }) => {\r\n  const editorRef = useRef(null);\r\n  useEffect(() => {\r\n    async function init() {\r\n      editorRef.current = Codemirror.fromTextArea(\r\n        document.getElementById(\"realtimeEditor\"),\r\n        {\r\n          mode: {\r\n            name: \"htmlmixed\",\r\n            json: true,\r\n          },\r\n          theme: \"dracula\",\r\n          autoCloseTags: true,\r\n          autoCloseBrackets: true,\r\n          lineNumbers: true,\r\n          matchBrackets: true,\r\n          extraKeys: { \"Ctrl-Space\": \"autocomplete\" },\r\n          hintOptions: {\r\n            completeSingle: false,\r\n          },\r\n        }\r\n      );\r\n\r\n      editorRef.current.on(\"change\", (instance, changes) => {\r\n        const { origin } = changes;\r\n        const code = instance.getValue();\r\n        onCodeChange(code);\r\n        if (origin !== \"setValue\") {\r\n          socketRef.current.emit(ACTIONS.CODE_CHANGE, {\r\n            roomId,\r\n            code,\r\n          });\r\n        }\r\n      });\r\n\r\n      editorRef.current.on(\"inputRead\", function (cm, change) {\r\n        if (\r\n          change.text.length === 1 &&\r\n          /^[a-zA-Z0-9_-]$/.test(change.text[0]) &&\r\n          !cm.state.completionActive\r\n        ) {\r\n          cm.showHint();\r\n        } else if (change.text[0] === \"!\") {\r\n          cm.setValue(\r\n            `<!DOCTYPE html>\\n<html lang=\"en\">\\n<head>\\n  <meta charset=\"UTF-8\">\\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\\n  <title>My HTML Page</title>\\n  <link rel=\"stylesheet\" href=\"styles.css\">\\n</head>\\n<body>\\n  <script src=\"script.js\"></script>\\n</body>\\n</html>`\r\n          );\r\n          cm.setCursor({ line: 5, ch: 2 });\r\n        }\r\n      });\r\n\r\n      editorRef.current.on(\"keyup\", function (cm, event) {\r\n        if (event.key === \".\") {\r\n          cm.showHint();\r\n        }\r\n      });\r\n    }\r\n    init();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (socketRef.current) {\r\n      socketRef.current.on(ACTIONS.CODE_CHANGE, ({ code }) => {\r\n        if (code !== null) {\r\n          editorRef.current.setValue(code);\r\n        }\r\n      });\r\n    }\r\n\r\n    return () => {\r\n      socketRef.current.off(ACTIONS.CODE_CHANGE);\r\n    };\r\n  }, [socketRef.current]);\r\n\r\n  return <textarea id=\"realtimeEditor\"></textarea>;\r\n};\r\n\r\nexport default Editor;\r\n"]},"metadata":{},"sourceType":"module"}